# Storage基礎

## 目次

1. [Storage概要](#1-storage概要)  
2. [HDD Storage](#2-hdd-storage)  
3. [Storageアーキテクチャ](#3-storageアーキテクチャ)  
4. [Tape Storage](#4-tape-storage)  
5. [SAN](#5-san)  
6. [NAS](#6-nas)  
7. [フラッシュStorage](#7-フラッシュstorage)

---

## 担当

- **野田さん**  
  - 北海道全域のお客様機器の保守導入作業  
  - GPU機器要員化に向け勉強中

- **新保さん**  
  - PureStorage製品の主管業務

---

## 到達目標

- システムにおけるStorageの役割を理解する  
- Storageの構成要素を理解する  
- DAS、NAS、SANの接続形態を理解する  
- HDDとSSDの違いを理解する  

---

## 1. Storage概要

### Storageとは

- データを保管する装置（HDD、SSDなど）
- RAIDコントローラを強化・独立させた装置

#### 主なメリット

- 無停止運用（冗長構成）
- 複数Serverで容量共有
- バックアップ・遠隔レプリケーション等の付加価値
- 優れた性能（CPU/メモリ/搭載ドライブ数）

#### 使命

- **データ保護**：データの安全な保存  
- **サービス継続**：いつでもアクセス可能  
- **性能確保**：高速な読み書き  

### 記憶装置の比較

| 種類       | 例   | 特徴                        | 価格         |
|------------|------|-----------------------------|--------------|
| 主記憶装置 | DRAM | 高速・低容量・揮発性        | 16GB → ¥8000 |
| 補助記憶装置 | HDD等 | 大容量・不揮発性・安価       | 8TB → ¥15000 |

#### 補助記憶装置の高速化手法

- キャッシュメモリ
- RAID
- SSD
- 仮想化（大容量・高速・効率）

### 実体と拡張方式

- OS + CPU + メモリ + ディスクで構成（＝最適化されたServer）
- **スケールアップ**：容量のみ増加  
- **スケールアウト**：ノード単位で増加（CPU＋容量）

### 用途別

| 種類               | 特徴                                 |
|--------------------|--------------------------------------|
| ブロックStorage    | SANブート対応・内蔵ディスク感覚       |
| ファイルStorage     | ファイル共有機能を搭載                |
| オブジェクトStorage | 大量データの配信・保存に最適          |

### 使用ドライブ別

| 種類                  | 特徴                                |
|-----------------------|-------------------------------------|
| オールフラッシュ      | SSDのみ使用、高速だが高価            |
| ハイブリッド          | SSD+HDD混在、性能とコスパ両立       |
| HDD                   | 全てHDD構成、大容量・長年の実績     |

---

## 2. HDD Storage

### 種類

| 名称      | 正式名               | 特徴                   | 用途                 |
|-----------|----------------------|------------------------|----------------------|
| SAS-HDD   | Serial Attached SCSI | 高性能・高信頼・高価格 | 本番系・DB・仮想化基盤 |
| SATA-HDD  | Serial ATA           | 低性能・低信頼・安価   | 開発・ファイル共有    |
| NL-SAS    | Nearline SAS         | 低性能・安価           | アーカイブ・バックアップ |

### 内部構造

- 制御基板（コントローラ/キャッシュ/モニタ）
- アクチュエータ（ヘッド位置決定）
- プラッタ、磁気ヘッド、スピンドルモータ、シークモータ

### アクセス方式と時間

- シークタイム + サーチタイム + データ転送時間
- **シーケンシャルアクセス**：高速
- **ランダムアクセス**：低速（SSDは得意）

### RAIDの基本

- **RAID1**：ミラーリング
- **RAID5/6/10**：ストライピング + パリティ
- **パリティ**：障害時のデータ復旧用の冗長情報
- **ライトペナルティ**：RAID5/6に存在

---

## 3. Storageアーキテクチャ

### 構成要素

| 項目             | 内容                         |
|------------------|------------------------------|
| シャーシ         | 各構成要素を収納する外殻     |
| コントローラ     | CPU/メモリ/インターフェース  |
| ミッドプレーン   | 構成要素を接続する基盤       |
| SPOF             | 単一障害点（低故障率設計）    |

### コントローラ内部

- デュアル構成（高可用性）
- NVRAM：不揮発性キャッシュメモリ
- Write Through / Write Back のモード選択
- キャッシュの冗長化やバッテリー保護

### フロントエンド / バックエンド接続

| 種別           | 規格例                     | 接続先                     |
|----------------|----------------------------|----------------------------|
| フロントエンド | FC、iSCSI                   | サーバ、スイッチ           |
| バックエンド   | SAS                         | 拡張筐体                   |

---

## 4. Tape Storage

### 特徴

- 安価・大容量・長期保存可能（5～30年）
- 主にバックアップ用途
- フル／差分／増分バックアップ

### LTO

| 世代 | 容量           | 転送速度     |
|------|----------------|--------------|
| LTO9 | 18TB（45TB圧縮）| 最大1000Mbps |

### メディア構造

- BOT/EOT（開始/終了点）
- EOF/IRG（ファイル/ブロック区切り）
- バーコード管理可能

### ドライブ・ライブラリ構成

- 接続インターフェース：FC（主流）、SATA（内蔵）
- ライブラリ：ロボット、マガジン、メールスロット等で構成

---

## 5. SAN

### SAN vs DAS

| 特徴       | SAN                          | DAS                           |
|------------|-------------------------------|--------------------------------|
| 接続方式   | FCネットワーク経由             | サーバ直結                     |
| メリット   | 高速・冗長・共有・集中管理     | 安価・シンプル運用             |
| デメリット | 高コスト・構築に専門知識必要   | スケーラビリティ・可用性に制限 |

### 接続方式

- **FC**（Fiber Channel）  
　高性能・高信頼・順序保証あり（ロスレス）

- **iSCSI**  
　LANベースで安価、小規模向け

### ゾーニング / 識別子

- **ゾーニング**：VLANのような概念でFC経路管理  
- **識別子**：WWN（FC）、IQN（iSCSI）

---

## 6. NAS

### 概要

- ネットワーク越しにファイル共有
- NFS（Linux/Unix）、CIFS/SMB（Windows）

| 比較項目     | NAS                     | SAN                     |
|--------------|--------------------------|--------------------------|
| プロトコル   | CIFS/SMB/NFS             | FCP/iSCSI                |
| アクセス方式 | ファイル                 | ブロック                 |
| 接続方式     | LAN                      | 専用ネットワーク         |

### ファイルStorageの進化

- ファイルサーバを内蔵し、セットアップ簡単
- 冗長構成、高可用性、高機能

### ユニファイドStorage

- 1台でSANとNASの両方に対応
- 導入コスト削減、管理負荷軽減
- データの種類に応じた柔軟な運用が可能

### オブジェクトStorage

- 構成：データ本体 + メタデータ + 一意ID  
- ファイル構造に依存せずスケーラブル  
- REST APIでアクセス
- AWS S3に代表されるクラウド連携

---

## 7. フラッシュStorage

### 特徴

- 機械的駆動部なし（故障に強い）
- 高速アクセス（ランダムI/O強い）
- 消費電力が少ない
- 小型・軽量

### 課題と対策

- 書き込み回数に限界  
　→ 製品側での耐久性対策、RAID/キャッシュ等で保護

### 書き込み動作

- 書き込み前にブロック消去が必要
- アドレス単位で直接上書き不可（HDDとの違い）

---

